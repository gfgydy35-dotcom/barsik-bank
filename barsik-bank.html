<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∞—Ä—Å–∏–∫-–ë–∞–Ω–∫ | –ü–ª–∞—Ç–µ–∂–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .terminal-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            width: 100%;
            max-width: 400px;
        }

        .terminal-header {
            background: #2c3e50;
            color: white;
            padding: 25px 20px;
            text-align: center;
        }

        .terminal-header h1 {
            font-size: 1.5em;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .bank-name {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .terminal-body {
            padding: 30px 25px;
        }

        .status-display {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
        }

        .amount {
            font-size: 2.8em;
            font-weight: 700;
            color: #2c3e50;
            margin: 15px 0;
        }

        .status-message {
            font-size: 1.1em;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn {
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219a52;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #3498db;
            color: #3498db;
        }

        .btn-outline:hover {
            background: #3498db;
            color: white;
        }

        .transaction-log {
            margin-top: 25px;
            border-top: 1px solid #e9ecef;
            padding-top: 20px;
        }

        .transaction-log h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f8f9fa;
        }

        .transaction-amount {
            font-weight: 600;
            color: #27ae60;
        }

        .transaction-time {
            color: #6c757d;
            font-size: 0.9em;
        }

        .nfc-animation {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: #3498db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
            color: white;
            font-size: 2em;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(52, 152, 219, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
        }

        .error-message {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <div class="terminal-header">
            <h1>üè¶ –ë–∞—Ä—Å–∏–∫-–ë–∞–Ω–∫</h1>
            <div class="bank-name">–ü–ª–∞—Ç–µ–∂–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª</div>
        </div>

        <div class="terminal-body">
            <div class="status-display">
                <div id="statusIcon" class="nfc-animation">üí≥</div>
                <div id="statusMessage" class="status-message">–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>
                <div id="amountDisplay" class="amount">0.00 ‚ÇΩ</div>
            </div>

            <div class="button-group">
                <button id="startPaymentBtn" class="btn btn-primary" onclick="startPayment()">
                    üí∏ –ù–∞—á–∞—Ç—å –ø—Ä–∏–µ–º –ø–ª–∞—Ç–µ–∂–∞
                </button>
                <button id="nfcScanBtn" class="btn btn-success" onclick="startNFCScan()" style="display: none;">
                    üì± –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å NFC
                </button>
                <button id="testPaymentBtn" class="btn btn-warning" onclick="simulatePayment()">
                    üéÆ –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
                </button>
                <button id="resetBtn" class="btn btn-outline" onclick="resetTerminal()" style="display: none;">
                    üîÑ –ù–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
                </button>
            </div>

            <div id="errorContainer" style="display: none;"></div>

            <div class="instructions" id="nfcInstructions" style="display: none;">
                <strong>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NFC:</strong><br>
                1. –ù–∞–∂–º–∏—Ç–µ "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å NFC"<br>
                2. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ NFC –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–æ—Å–∏—Ç<br>
                3. –ü–æ–¥–Ω–µ—Å–∏—Ç–µ NFC –º–µ—Ç–∫—É –∫ —Ç–µ–ª–µ—Ñ–æ–Ω—É
            </div>

            <div class="transaction-log">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
                <div id="paymentLog"></div>
            </div>
        </div>
    </div>

    <script>
        let nfcReader = null;
        let currentAmount = 100.00;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function checkDevice() {
            const isPhone = /Android|iPhone|iPad/i.test(navigator.userAgent);
            if (!isPhone) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ç–µ—Ä–º–∏–Ω–∞–ª–∞');
            }
            initNFC();
        }

        async function initNFC() {
            if (!('NDEFReader' in window)) {
                document.getElementById('nfcInstructions').style.display = 'block';
                return;
            }
            
            try {
                nfcReader = new NDEFReader();
                console.log('NFC –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } catch (error) {
                console.log('NFC –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω:', error);
            }
        }

        function startPayment() {
            currentAmount = 100.00;
            updateDisplay('üí≥', '–ì–æ—Ç–æ–≤ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é', currentAmount.toFixed(2) + ' ‚ÇΩ');
            document.getElementById('startPaymentBtn').style.display = 'none';
            document.getElementById('nfcScanBtn').style.display = 'flex';
            document.getElementById('testPaymentBtn').style.display = 'flex';
            document.getElementById('nfcInstructions').style.display = 'block';
            hideError();
        }

        async function startNFCScan() {
            if (!nfcReader) {
                showError('NFC –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome –Ω–∞ Android.');
                return;
            }

            updateDisplay('üì±', '–ü—Ä–∏–ª–æ–∂–∏—Ç–µ NFC –º–µ—Ç–∫—É...', currentAmount.toFixed(2) + ' ‚ÇΩ');
            
            try {
                await nfcReader.scan();
                
                nfcReader.onreading = event => {
                    console.log('NFC –º–µ—Ç–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞');
                    processPayment('NFC –ö–∞—Ä—Ç–∞ ****' + Math.floor(Math.random() * 10000));
                };
                
                nfcReader.onreadingerror = event => {
                    console.error('–û—à–∏–±–∫–∞ NFC:', event);
                    showError('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è NFC. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç–∫—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                };
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ NFC:', error);
                if (error.name === 'NotAllowedError') {
                    showError('–î–æ—Å—Ç—É–ø –∫ NFC –∑–∞–ø—Ä–µ—â–µ–Ω. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.');
                } else {
                    showError('–û—à–∏–±–∫–∞ NFC: ' + error.message);
                }
            }
        }

        function simulatePayment() {
            processPayment('–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ****1234');
        }

        function processPayment(cardInfo) {
            updateDisplay('‚úÖ', '–ü–ª–∞—Ç–µ–∂ –≤—ã–ø–æ–ª–Ω–µ–Ω!', currentAmount.toFixed(2) + ' ‚ÇΩ');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞
            document.getElementById('nfcScanBtn').style.display = 'none';
            document.getElementById('testPaymentBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'flex';
            document.getElementById('nfcInstructions').style.display = 'none';
            hideError();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            addToPaymentLog(currentAmount, cardInfo);
        }

        function resetTerminal() {
            updateDisplay('üí≥', '–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', '0.00 ‚ÇΩ');
            document.getElementById('startPaymentBtn').style.display = 'flex';
            document.getElementById('nfcScanBtn').style.display = 'none';
            document.getElementById('testPaymentBtn').style.display = 'flex';
            document.getElementById('resetBtn').style.display = 'none';
            document.getElementById('nfcInstructions').style.display = 'none';
            hideError();
        }

        function updateDisplay(icon, message, amount) {
            document.getElementById('statusIcon').textContent = icon;
            document.getElementById('statusMessage').textContent = message;
            document.getElementById('amountDisplay').textContent = amount;
        }

        function addToPaymentLog(amount, cardInfo) {
            const log = document.getElementById('paymentLog');
            const transaction = document.createElement('div');
            transaction.className = 'transaction-item';
            
            const now = new Date();
            const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                             now.getMinutes().toString().padStart(2, '0');
            
            transaction.innerHTML = `
                <div>
                    <div>${cardInfo}</div>
                    <div class="transaction-time">${timeString}</div>
                </div>
                <div class="transaction-amount">+${amount.toFixed(2)} ‚ÇΩ</div>
            `;
            
            log.insertBefore(transaction, log.firstChild);
        }

        function showError(message) {
            const errorContainer = document.getElementById('errorContainer');
            errorContainer.innerHTML = `<div class="error-message">${message}</div>`;
            errorContainer.style.display = 'block';
        }

        function hideError() {
            document.getElementById('errorContainer').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = checkDevice;
    </script>
</body>
</html>
