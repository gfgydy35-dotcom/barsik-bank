<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∞—Ä—Å–∏–∫-–ë–∞–Ω–∫ | –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</title>
    <!-- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è NFC -->
    <meta http-equiv="Permissions-Policy" content="nfc=(self)">
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            min-height: 100vh;
        }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ö–û–ú–ü–¨–Æ–¢–ï–†–ê */
        .computer-interface {
            max-width: 1000px;
            margin: 0 auto;
            display: none;
        }
        
        .header {
            background: #1e3a8a;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .card-creator {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .card-creator input {
            padding: 10px;
            margin: 10px 0;
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .card-creator button {
            background: #1e3a8a;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
        }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¢–ï–õ–ï–§–û–ù–ê */
        .phone-interface {
            display: none;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .terminal {
            background: #1a1a1a;
            color: #00ff00;
            padding: 30px 20px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            text-align: center;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .terminal h2 {
            margin-bottom: 30px;
            font-size: 1.5em;
        }
        
        .amount {
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .terminal button {
            background: #00ff00;
            color: black;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
        }
        
        .scanning {
            animation: pulse 1.5s infinite;
            font-size: 1.2em;
            margin: 20px 0;
        }
        
        .success {
            color: #00ff00;
            font-size: 1.3em;
            margin: 20px 0;
        }
        
        .error {
            color: #ff4444;
            margin: 10px 0;
        }
        
        #paymentLog {
            margin-top: 20px;
            font-size: 0.9em;
            text-align: left;
            max-height: 150px;
            overflow-y: auto;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- –ö–û–ú–ü–¨–Æ–¢–ï–†–ù–´–ô –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div class="computer-interface" id="computerInterface">
        <div class="header">
            <h1>üè¶ –ë–∞—Ä—Å–∏–∫-–ë–∞–Ω–∫ (–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)</h1>
            <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Ä—Ç—ã –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏</p>
        </div>
        
        <div class="card-creator">
            <h2>üé® –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É</h2>
            <input type="text" id="cardName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã">
            <button onclick="createCard()">–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É</button>
            <div id="cardsList"></div>
        </div>
        
        <div class="card-creator">
            <h2>üìã –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
            <div id="transactionsList"></div>
        </div>
    </div>

    <!-- –¢–ï–õ–ï–§–û–ù–ù–´–ô –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ç–µ—Ä–º–∏–Ω–∞–ª) -->
    <div class="phone-interface" id="phoneInterface">
        <div class="terminal">
            <h2>üí≥ –¢–µ—Ä–º–∏–Ω–∞–ª –ë–∞—Ä—Å–∏–∫-–ë–∞–Ω–∫–∞</h2>
            <div id="terminalDisplay">
                <p>–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</p>
                <p class="amount">0.00 ‚ÇΩ</p>
            </div>
            <button onclick="startPayment()">üí∏ –ù–∞—á–∞—Ç—å –ø—Ä–∏–µ–º –ø–ª–∞—Ç–µ–∂–∞</button>
            <div id="paymentLog"></div>
        </div>
    </div>

    <script>
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function checkDevice() {
            const isPhone = /Android|iPhone|iPad/i.test(navigator.userAgent);
            
            if (isPhone) {
                document.getElementById('computerInterface').style.display = 'none';
                document.getElementById('phoneInterface').style.display = 'block';
                console.log('–ó–∞–ø—É—â–µ–Ω —Ä–µ–∂–∏–º –¢–ï–†–ú–ò–ù–ê–õ–ê –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ');
                initNFC(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º NFC –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            } else {
                document.getElementById('computerInterface').style.display = 'block';
                document.getElementById('phoneInterface').style.display = 'none';
                console.log('–ó–∞–ø—É—â–µ–Ω —Ä–µ–∂–∏–º –ê–î–ú–ò–ù–ê –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ');
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ö–û–ú–ü–¨–Æ–¢–ï–†–ê
        function createCard() {
            const cardName = document.getElementById('cardName').value;
            if (!cardName) return;
            
            alert('–ö–∞—Ä—Ç–∞ "' + cardName + '" —Å–æ–∑–¥–∞–Ω–∞!');
            document.getElementById('cardName').value = '';
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¢–ï–õ–ï–§–û–ù–ê —Å NFC
        let nfcReader = null;

        async function initNFC() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É Web NFC
            if (!('NDEFReader' in window)) {
                document.getElementById('terminalDisplay').innerHTML = 
                    '<p class="error">‚ùå Web NFC –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</p>' +
                    '<p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome 89+ –Ω–∞ Android</p>' +
                    '<p>–ò–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ —Ñ–ª–∞–≥: chrome://flags/#enable-experimental-web-platform-features</p>';
                return;
            }
            
            try {
                nfcReader = new NDEFReader();
                document.getElementById('terminalDisplay').innerHTML = 
                    '<p>‚úÖ NFC –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</p>' +
                    '<p class="amount">0.00 ‚ÇΩ</p>' +
                    '<button onclick="startNFCScan()">üîç –ó–∞–ø—É—Å—Ç–∏—Ç—å NFC —Å–∫–∞–Ω–µ—Ä</button>';
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ NFC:', error);
                document.getElementById('terminalDisplay').innerHTML = 
                    '<p class="error">‚ùå –û—à–∏–±–∫–∞ NFC</p>' +
                    '<p>' + error.message + '</p>';
            }
        }

        async function startPayment() {
            document.getElementById('terminalDisplay').innerHTML = 
                '<p>üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–∞</p>' +
                '<p class="amount">100.00 ‚ÇΩ</p>' +
                '<button onclick="startNFCScan()">üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å NFC –º–µ—Ç–∫—É</button>' +
                '<button onclick="simulatePayment()" style="background: #ff9900;">üéÆ –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂</button>';
        }

        async function startNFCScan() {
            if (!nfcReader) {
                alert('NFC –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return;
            }
            
            try {
                document.getElementById('terminalDisplay').innerHTML = 
                    '<p>üì± –ü—Ä–∏–ª–æ–∂–∏—Ç–µ NFC –º–µ—Ç–∫—É</p>' +
                    '<p class="amount">100.00 ‚ÇΩ</p>' +
                    '<div class="scanning">‚è≥ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...</div>' +
                    '<button onclick="resetTerminal()">‚ùå –û—Ç–º–µ–Ω–∞</button>';
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
                await nfcReader.scan();
                
                nfcReader.onreading = event => {
                    console.log('NFC –º–µ—Ç–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞!', event);
                    const message = event.message;
                    let cardData = 'NFC –º–µ—Ç–∫–∞';
                    
                    if (message.records && message.records.length > 0) {
                        const record = message.records[0];
                        if (record.recordType === "text") {
                            const textDecoder = new TextDecoder(record.encoding);
                            cardData = textDecoder.decode(record.data);
                        } else if (record.recordType === "url") {
                            const textDecoder = new TextDecoder();
                            cardData = textDecoder.decode(record.data);
                        }
                    }
                    
                    // –°–∏–º—É–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
                    processPayment(cardData);
                };
                
                nfcReader.onreadingerror = (error) => {
                    console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è NFC:', error);
                    document.getElementById('terminalDisplay').innerHTML = 
                        '<p class="error">‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è NFC</p>' +
                        '<p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –º–µ—Ç–∫—É</p>' +
                        '<button onclick="startNFCScan()">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>';
                };
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è NFC:', error);
                document.getElementById('terminalDisplay').innerHTML = 
                    '<p class="error">‚ùå –û—à–∏–±–∫–∞: ' + error.message + '</p>' +
                    '<p>–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ NFC –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞</p>' +
                    '<button onclick="startNFCScan()">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>' +
                    '<button onclick="simulatePayment()">üéÆ –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂</button>';
            }
        }

        function simulatePayment() {
            processPayment('–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ****1234');
        }

        function processPayment(cardData) {
            // –°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞
            document.getElementById('terminalDisplay').innerHTML = 
                '<p>‚úÖ –ü–ª–∞—Ç–µ–∂ –ø—Ä–∏–Ω—è—Ç!</p>' +
                '<p class="amount">100.00 ‚ÇΩ</p>' +
                '<p>–ö–∞—Ä—Ç–∞: ' + cardData + '</p>' +
                '<div class="success">üéâ –û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞</div>' +
                '<button onclick="resetTerminal()">üîÑ –ù–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂</button>';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            addToPaymentLog('‚úÖ –ü–ª–∞—Ç–µ–∂ 100.00 ‚ÇΩ | ' + new Date().toLocaleTimeString());
        }

        function resetTerminal() {
            document.getElementById('terminalDisplay').innerHTML = 
                '<p>‚úÖ –¢–µ—Ä–º–∏–Ω–∞–ª –≥–æ—Ç–æ–≤</p>' +
                '<p class="amount">0.00 ‚ÇΩ</p>' +
                '<button onclick="startPayment()">üí∏ –ù–∞—á–∞—Ç—å –ø—Ä–∏–µ–º –ø–ª–∞—Ç–µ–∂–∞</button>';
        }

        function addToPaymentLog(message) {
            const log = document.getElementById('paymentLog');
            const entry = document.createElement('div');
            entry.textContent = message;
            entry.style.padding = '5px';
            entry.style.borderBottom = '1px solid #333';
            log.appendChild(entry);
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = checkDevice;
    </script>
</body>
</html>
